<div class="row">
  <div class="col-sm-9">
    <h1>Your transportation(s) in <%= @trip.destination %>!</h1>
  </div>
  <div class="col-sm-3 text-xs-right">
    <%= link_to new_trip_transportation_path,  class:"btn btn-outline-primary" do %>
      <i class="fa fa-plus" aria-hidden="true"></i> Add a transportation
    <% end %>
  </div>
</div>
<hr>
<br>
<br>

<% @transportations.each do |transportation| %>
  <!-- details of transportation -->
  <div class="row">
  <div class="col-sm-6">
    <div class="card card-block">
          <h4 class="card-title">Details :</h4>
      <p><i class="fa fa-globe" aria-hidden="true"></i> City of departure : <%= transportation.departure_city %></p>
      <p><i class="fa fa-calendar-check-o" aria-hidden="true"></i> Departure : <%= (transportation.departure_datetime).strftime("%d/%m/%Y at %H:%M" ) %></p>
      <p><i class="fa fa-calendar-check-o" aria-hidden="true"></i> Arrival : <%= (transportation.arrival_datetime).strftime("%d/%m/%Y at %H:%M" ) %> </p>
        <% unless transportation.return_date_departure == nil %>
          <p>
            <strong><i class="fa fa-undo" aria-hidden="true"></i> Return date : </strong>
            <br>
            <i class="fa fa-calendar-check-o" aria-hidden="true"></i> Departure : <%= (transportation.return_date_departure).strftime("%d/%m/%Y at %H:%M" ) %><br>
            <i class="fa fa-calendar-check-o" aria-hidden="true"></i> Arrival : <%= (transportation.return_date_arrival).strftime("%d/%m/%Y at %H:%M" ) %>
          </p>
        <% end %>
      </p>
      <p>
        <i class="fa fa-eur" aria-hidden="true"></i> Price :
        <% if transportation.price? %>
           <%= number_to_currency(transportation.price_per_personne, unit: "€") %> / per traveler </p>
        <% else %>
          <span>Free </span>
      <% end %>
      <p>Booking n°: <%= transportation.reference_number %></p>
      <p>
        <% if transportation.link? %>
          <%= link_to transportation.link, target: "_blank", class:"btn btn-primary btn-sm active" do %>
            <% if transportation.company? %>
              <i class="fa fa-arrow-circle-right" aria-hidden="true"></i> Open the link  <%= (transportation.company).capitalize %>
            <% else %>
              <i class="fa fa-arrow-circle-right" aria-hidden="true"></i> Check your booking on the company's website
            <% end %>
          <% end %>
        <% end %>
      </p>

      <div class="row">
        <div class="col-sm-8">
          <%= link_to 'Back', trips_path, class:"btn btn-warning" %>
          <%= link_to 'Edit', edit_trip_transportation_path(@trip, transportation), class:"btn btn-primary" %>
        </div>
        <div class="col-sm-4 text-xs-right">
          <%= link_to "<i class='fa fa-trash-o fa-2x' aria-hidden='true'></i> Supprimer".html_safe, trip_transportation_path(@trip, transportation), method: :delete, data: { confirm: "Confirmez la suppression" } %>
        </div>
      </div>
    </div>
  </div>

  <!-- Billets -->
  <div class="col-md-6">
    <div class="card card-block">
      <div class="row">
        <div class="col-sm-10">
          <h4 class="card-title">Document(s) :</h4>
        </div>
        <div class="col-sm-2 text-xs-right">
          <%= link_to new_trip_transportation_ticket_path(@trip, transportation) do %>
            <i class="fa fa-upload fa-2x" aria-hidden="true"></i>
          <% end %>
        </div>
      </div>
      <hr>

      <% if transportation.tickets.empty? %>
      <div class="col-xs-12 text-xs-center">
        <p>
          You don't have document(s)
        </p>
        <%= simple_form_for [@trip, transportation, transportation.tickets.new] do |f|  %>
          <%= f.filepicker_field :filepicker_url, button_text: "<i class='fa fa-upload' aria-hidden='true'></i> Upload a document".html_safe, button_class:"btn btn-outline-secondary btn-sm", services: "COMPUTER, GMAIL, GOOGLE_DRIVE, DROPBOX" %>
          <br>
          <br>
          <%= button_tag(type: 'submit', class: "btn btn-primary btn-sm") do %>
          <i class="fa fa-check" aria-hidden="true"></i> Click to confirm upload
          <% end %>
        <% end %>
      </div>
    <% else %>
    <div class="col-sm-12">
      <% transportation.tickets.each do |ticket| %>
        <div class="col-sm-6 text-xs-center card-doc">
          <%= link_to ticket.filepicker_url do %>
            <%= filepicker_image_tag ticket.filepicker_url, w: 300, h: 300, fit: 'clip' %>
          <% end %>
        <div class="col-xs-12 text-xs-center">
          <%= link_to trip_transportation_ticket_path(@trip, transportation, ticket), method: :delete do %>
            <i class='fa fa-trash-o fa-2x' aria-hidden='true'></i>
          <% end %>
        </div>
      </div>
      <% end %>
    </div>

  <% end %>
  </div>
</div>
</div>
<% end %>
